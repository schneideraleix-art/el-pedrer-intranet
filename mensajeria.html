<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Mensajer√≠a - El Pedrer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --sidebar-bg: #1a1d2b; --accent-red: #ff4d4d; --bg-light: #f4f7f9; --accent-blue: #4285f4; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; background-color: #e5ddd5; height: 100vh; overflow: hidden; }
        
        .sidebar { width: 240px; background-color: var(--sidebar-bg); color: white; padding: 20px; flex-shrink: 0; }
        .logo { font-size: 1.5rem; font-weight: bold; margin-bottom: 40px; }
        .nav-item { padding: 12px; margin-bottom: 5px; border-radius: 8px; display: flex; align-items: center; gap: 10px; cursor: pointer; color: #aeb2b9; text-decoration: none; }
        .nav-item.active { background: var(--accent-red); color: white; }

        /* Contenedor Mensajer√≠a */
        .messenger-container { flex-grow: 1; display: grid; grid-template-columns: 350px 1fr; background: white; margin: 20px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); overflow: hidden; }
        
        /* Lista de Chats */
        .chat-list { border-right: 1px solid #eee; background: #f9f9f9; overflow-y: auto; }
        .contact { padding: 15px; display: flex; align-items: center; gap: 12px; border-bottom: 1px solid #f0f0f0; cursor: pointer; transition: 0.3s; }
        .contact:hover { background: #fff; }
        .avatar { width: 45px; height: 45px; background: #ccc; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; color: white; }

        /* Ventana de Chat */
        .chat-window { display: flex; flex-direction: column; background: #efeae2; }
        .chat-header { padding: 15px 25px; background: #f0f2f5; display: flex; align-items: center; gap: 15px; border-bottom: 1px solid #ddd; }
        .chat-messages { flex-grow: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        
        /* Burbujas de Mensaje */
        .msg { max-width: 70%; padding: 10px 15px; border-radius: 10px; font-size: 0.9rem; position: relative; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .msg.system { align-self: center; background: #e3f2fd; border: 1px solid #bbdefb; color: #1976d2; text-align: center; width: 90%; margin: 10px 0; }
        .msg.received { align-self: flex-start; background: white; border-bottom-left-radius: 2px; }
        .msg.sent { align-self: flex-end; background: #d9fdd3; border-bottom-right-radius: 2px; }
        .time { font-size: 0.7rem; color: #999; margin-top: 5px; text-align: right; display: block; }

        .chat-input { padding: 15px; background: #f0f2f5; display: flex; gap: 10px; }
        .chat-input input { flex-grow: 1; padding: 10px; border: none; border-radius: 20px; outline: none; }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo">üèõÔ∏è EL PEDRER</div>
        <a href="direccion.html" class="nav-item"><i class="fas fa-th-large"></i> Dashboard</a>
        <a href="horarios.html" class="nav-item"><i class="fas fa-clock"></i> Horarios</a>
        <a href="mensajeria.html" class="nav-item active"><i class="fas fa-comment-dots"></i> Mensajer√≠a</a>
    </div>

    <div class="messenger-container">
        <div class="chat-list">
            <div style="padding: 20px; font-weight: bold; font-size: 1.2rem;">Chats</div>
            <div class="contact" style="background: #e3f2fd;">
                <div class="avatar" style="background: #4285f4;">S</div>
                <div><strong>Avisos del Sistema</strong><br><small style="color: #4285f4;">En l√≠nea</small></div>
            </div>
            <div class="contact">
                <div class="avatar" style="background: #ff4d4d;">GA</div>
                <div><strong>Garc√≠a, Alberto</strong><br><small>Hola, ¬øpuedes confirmar...</small></div>
            </div>
        </div>

        <div class="chat-window">
            <div class="chat-header">
                <div class="avatar" style="background: #4285f4;">S</div>
                <div><strong>Notificaciones Autom√°ticas</strong></div>
            </div>

            <div class="chat-messages" id="chatBox">
                <div class="msg system">Bienvenido al centro de notificaciones de El Pedrer. Aqu√≠ recibir√°s avisos de cambios de horario.</div>
            </div>

            <div class="chat-input">
                <input type="text" placeholder="Escribe un mensaje...">
                <button style="border:none; background:none; color:var(--accent-blue); cursor:pointer;"><i class="fas fa-paper-plane fa-lg"></i></button>
            </div>
        </div>
    </div>

    <script>
        function checkNotifications() {
            const mensajes = JSON.parse(localStorage.getItem('mensajesNuevos')) || [];
            const chatBox = document.getElementById('chatBox');

            if(mensajes.length > 0) {
                mensajes.forEach(m => {
                    const div = document.createElement('div');
                    div.className = "msg system";
                    div.innerHTML = `
                        <strong>NUEVA ASIGNACI√ìN</strong><br>
                        ${m.contenido}
                        <span class="time">${m.tiempo}</span>
                    `;
                    chatBox.appendChild(div);
                });
                // Limpiar despu√©s de leer para no duplicar en el scroll
                localStorage.removeItem('mensajesNuevos');
                chatBox.scrollTop = chatBox.scrollHeight;
            }
        }
        // Comprobar cada 1.5 segundos
        setInterval(checkNotifications, 1500);
        window.onload = checkNotifications;
    </script>
</body>
</html>
