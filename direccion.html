<div id="pePhoneContainer" style="display:none; position:fixed; bottom:20px; right:20px; width:300px; height:550px; background:#111; border-radius:40px; border:8px solid #333; overflow:hidden; z-index:99999; box-shadow:0 20px 50px rgba(0,0,0,0.5); font-family: sans-serif;">
    
    <div style="background: linear-gradient(180deg, #1a1a1a 0%, #000 100%); height:100%; color:white; padding:20px; display:flex; flex-direction:column; align-items:center;">
        
        <div style="width:60px; height:5px; background:#333; border-radius:10px; margin-bottom:40px;"></div>
        
        <div id="phoneStatus" class="text-success small mb-2">● En línea</div>
        <h5 id="callerName" style="font-weight: 300; margin-bottom:5px;">674 02 02 47</h5>
        <div id="callTimer" style="font-size: 0.8rem; opacity:0.6; margin-bottom:40px;">Llamada entrante...</div>

        <div id="phoneAvatar" style="width:120px; height:120px; background:#333; border-radius:50%; display:flex; align-items:center; justify-content:center; margin-bottom:50px; border:2px solid #444;">
            <i class="bi bi-person-fill" style="font-size: 4rem; color:#666;"></i>
        </div>

        <div id="peBotResponse" style="background:rgba(255,255,255,0.05); padding:15px; border-radius:15px; width:100%; font-size:0.8rem; margin-bottom:40px; text-align:center; border:1px solid rgba(255,255,255,0.1);">
            <i class="bi bi-robot"></i> <span id="botMsg">Asistente filtrando...</span>
        </div>

        <div style="display:flex; gap:30px;">
            <button onclick="acceptPeCall()" style="width:60px; height:60px; border-radius:50%; background:#22c55e; border:none; color:white; font-size:1.5rem; cursor:pointer; box-shadow: 0 0 20px rgba(34,197,94,0.4);">
                <i class="bi bi-telephone-fill"></i>
            </button>
            <button onclick="rejectPeCall()" style="width:60px; height:60px; border-radius:50%; background:#ef4444; border:none; color:white; font-size:1.5rem; cursor:pointer;">
                <i class="bi bi-telephone-x-fill"></i>
            </button>
        </div>
    </div>
</div>

<script>
    // Sistema de Audio Estilo pe-phone
    const peRing = new Audio('https://files.freemusicarchive.org/storage-freemusicarchive-org/music/no_curator/Xylo-Ziko/Phase/Xylo-Ziko_-_03_-_Phase.mp3'); // Tono chill estilo juego

    function simularLlamadaPePhone() {
        document.getElementById('pePhoneContainer').style.display = 'block';
        peRing.play();
        peRing.loop = true;

        // El Bot asistente (IVR) habla gratis
        const synth = window.speechSynthesis;
        const intro = new SpeechSynthesisUtterance("Bienvenido a la centralita de El Pedrer. Un momento por favor.");
        synth.speak(intro);

        setTimeout(() => {
            document.getElementById('botMsg').innerText = "Preguntando motivo...";
        }, 2000);
    }

    function acceptPeCall() {
        peRing.pause();
        document.getElementById('callTimer').innerText = "00:01";
        document.getElementById('botMsg').innerText = "CONECTADO - AUDIO OK";
        document.getElementById('phoneAvatar').style.borderColor = "#22c55e";
        
        // ACTIVAR MICRO REAL (P2P)
        navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
            console.log("Stream de voz iniciado estilo pe-phone");
        });
    }

    function rejectPeCall() {
        peRing.pause();
        document.getElementById('pePhoneContainer').style.display = 'none';
    }

    // Activar simulación al cargar
    setTimeout(simularLlamadaPePhone, 3000);
</script>
