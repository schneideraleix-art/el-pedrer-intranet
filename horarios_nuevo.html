<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>A√±adir Nueva Sesi√≥n - El Pedrer</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --sidebar-bg: #1a1d2b; --accent-red: #ff4d4d; --bg-light: #f4f7f9; --accent-blue: #4285f4; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; background-color: var(--bg-light); height: 100vh; overflow: hidden; }
        .sidebar { width: 240px; background-color: var(--sidebar-bg); color: white; padding: 20px; display: flex; flex-direction: column; }
        .logo { font-size: 1.5rem; font-weight: bold; margin-bottom: 40px; }
        .nav-item { padding: 12px; margin-bottom: 5px; border-radius: 8px; display: flex; align-items: center; gap: 10px; cursor: pointer; color: #aeb2b9; text-decoration: none; }
        .nav-item.active { background: var(--accent-red); color: white; }
        .main-content { flex-grow: 1; padding: 40px; overflow-y: auto; }
        .form-card { background: white; padding: 35px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); max-width: 900px; margin: 0 auto; }
        .grid-form { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .full-width { grid-column: span 3; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.85rem; color: #555; }
        .form-group select, .form-group input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; }
        .btn-save { background: var(--accent-red); color: white; border: none; padding: 16px; border-radius: 12px; width: 100%; font-weight: bold; cursor: pointer; margin-top: 20px; }
        .btn-centralita { position: fixed; bottom: 20px; left: 20px; width: 200px; background: var(--accent-blue); color: white; padding: 14px; border-radius: 12px; text-decoration: none; font-weight: bold; text-align: center; }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="logo">üèõÔ∏è EL PEDRER</div>
        <a href="horarios.html" class="nav-item"><i class="fas fa-arrow-left"></i> Volver a Gesti√≥n</a>
        <div class="nav-item active"><i class="fas fa-plus"></i> Nueva Sesi√≥n</div>
        <a href="centralita.html" class="btn-centralita"><i class="fas fa-headset"></i> CENTRALITA IP</a>
    </div>

    <div class="main-content">
        <h1>A√±adir Nueva Sesi√≥n</h1>
        <div class="form-card">
            <div class="grid-form">
                <div class="form-group full-width">
                    <label>Asignatura / Materia</label>
                    <select id="selectMateria"></select>
                </div>
                <div class="form-group">
                    <label>Docente</label>
                    <select id="selectDocente"></select>
                </div>
                <div class="form-group">
                    <label>Tipo de Sesi√≥n</label>
                    <select id="tipo"><option>Lectiva Est√°ndar</option><option>Guardia</option></select>
                </div>
                <div class="form-group">
                    <label>Aula</label>
                    <select id="selectAula"></select>
                </div>
                <div class="form-group">
                    <label>D√≠a</label>
                    <select id="dia"><option>Lunes</option><option>Martes</option><option>Mi√©rcoles</option><option>Jueves</option><option>Viernes</option></select>
                </div>
                <div class="form-group">
                    <label>Hora Inicio</label>
                    <select id="hora"><option>08:00</option><option>09:00</option><option>10:30</option><option>11:30</option></select>
                </div>
            </div>
            <button class="btn-save" onclick="saveSession()"><i class="fas fa-save"></i> GUARDAR EN HORARIO</button>
        </div>
    </div>

    <script>
        // Carga masiva de datos
        const materias = ["Matem√°ticas", "Lengua", "Ingl√©s", "F√≠sica", "Qu√≠mica", "Biolog√≠a", "Historia", "Geograf√≠a", "Filosof√≠a", "E. F√≠sica", "M√∫sica", "Tecnolog√≠a", "Inform√°tica", "Lat√≠n", "Dibujo", "Franc√©s", "Rob√≥tica", "Tutor√≠a", "Econom√≠a", "Pl√°stica"];
        const mSelect = document.getElementById('selectMateria');
        const dSelect = document.getElementById('selectDocente');
        const aSelect = document.getElementById('selectAula');

        materias.forEach(m => mSelect.innerHTML += `<option>${m}</option>`);
        for(let i=1; i<=150; i++) dSelect.innerHTML += `<option>Profesor/a ${i}</option>`;
        for(let j=1; j<=58; j++) aSelect.innerHTML += `<option>Aula ${j}</option>`;

        function saveSession() {
            const nuevaSesion = {
                materia: mSelect.value,
                docente: dSelect.value,
                aula: aSelect.value,
                dia: document.getElementById('dia').value,
                hora: document.getElementById('hora').value
            };

            // Guardar para horarios.html
            let sesiones = JSON.parse(localStorage.getItem('sesionesHorario')) || [];
            sesiones.push(nuevaSesion);
            localStorage.setItem('sesionesHorario', JSON.stringify(sesiones));

            // Notificaci√≥n para mensajeria.html
            let mensajes = JSON.parse(localStorage.getItem('mensajesNuevos')) || [];
            mensajes.push({
                emisor: "Sistema",
                contenido: `Nueva sesi√≥n: ${nuevaSesion.materia} en ${nuevaSesion.aula} (${nuevaSesion.dia} ${nuevaSesion.hora})`,
                tiempo: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
            });
            localStorage.setItem('mensajesNuevos', JSON.stringify(mensajes));

            alert("Sesi√≥n guardada y docente notificado.");
            window.location.href = "horarios.html";
        }
    </script>
</body>
</html>
